name: xrvk8s
prefix: ""

topology:

  nodes:
    ### fabric ###
    xrvleaf1:
      kind: cisco_xrv
      startup-config: configs/xrvleaf1.cfg
    xrvleaf2:
      kind: cisco_xrv
      startup-config: configs/xrvleaf2.cfg
    xrvspine:
      kind: cisco_xrv
      image: vrnetlab/vr-xrv:6.1.2
      startup-config: configs/xrvspine.cfg
    br-clab:
      kind: bridge

    ### minikube cluster ###
    mkcluster:
      kind: ext-container
      exec:
        - ip address add 192.168.200.11/24 dev eth1
        - ip route add 192.168.200.1/16 via 192.168.1.1
    mkcluster-m02:
      kind: ext-container
      exec:
        - ip address add 192.168.200.22/24 dev eth1
        - ip route add 192.168.200.1/16 via 192.168.1.1

    ####  clients ###
    client:
      kind: linux
      image: ghcr.io/hellt/network-multitool
      binds:
        - configs/client-config.sh:/client-config.sh
      exec:
        - bash /client-config.sh 192.168.100.11

  links:
    ### #### fabric ### ####
    - endpoints: ["xrvspine:eth2", "xrvleaf1:eth1"]
    - endpoints: ["xrvspine:eth1", "xrvleaf2:eth1"]

    #### minikube ####
    - endpoints: ["xrvleaf2:eth2", "br-clab:eth1"]
    - endpoints: ["mkcluster:eth1", "br-clab:eth2"]
    - endpoints: ["mkcluster-m02:eth1", "br-clab:eth3"]

    #### clients ####
    - endpoints: ["client1:eth1", "xrvleaf1:eth2"]

